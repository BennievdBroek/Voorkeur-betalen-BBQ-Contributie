<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Betaalvoorkeur contributie + BBQ formulier</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 2rem;
      display: flex;
      justify-content: center;
    }
    .card {
      background: white;
      padding: 2rem;
      border-radius: 20px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.15);
      max-width: 650px;
      width: 100%;
    }
    .logo { text-align: center; margin-bottom: 1rem; }
    .logo img { max-height: 200px; }
    h1 {
      text-align: center;
      color: #1e6b34;
      margin-bottom: 2rem;
      font-size: 2.2rem;
      font-weight: bold;
      text-shadow: 2px 2px 0 #e6ffe6, 4px 4px 0 #006b6b;
    }
    h3 { margin-top: 2rem; color: #006b6b; }
    label { display:block; margin-top:1rem; font-weight: bold; color:#333; }
    input, select {
      width: 100%;
      padding: .6rem;
      margin-top:.3rem;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    button {
      margin-top: 1.5rem;
      padding: .8rem 1.5rem;
      border:none;
      border-radius: 8px;
      background:#1e6b34;
      color:white;
      font-size:1rem;
      cursor:pointer;
    }
    button:hover { background:#145023; }
    .totaal { margin-top:1rem; font-weight:bold; font-size:1.2rem; color:#000; }
    .hidden { display:none; }
    .bedankt {
      text-align:center;
      padding:2rem;
      background:#e6ffe6;
      border:2px solid #1e6b34;
      border-radius:15px;
      margin-top:1rem;
      font-size:1.1rem;
      color:#1e6b34;
      font-weight:bold;
    }
    #confetti-canvas {
      position: fixed;
      top:0; left:0;
      width:100%; height:100%;
      pointer-events: none;
      z-index: 999;
    }
    #foutmelding { color:red; margin-top:1rem; display:none; }
  </style>
</head>
<body>
  <canvas id="confetti-canvas"></canvas>

  <!-- Login kaart -->
  <div class="card" id="loginCard">
    <div class="logo">
      <img src="Logo%20akkerlinge%20basis.png" alt="Akkerlinge logo">
    </div>
    <h1>Betaalvoorkeur contributie + BBQ formulier</h1>
    <p>Voer het wachtwoord in om het formulier te bekijken.</p>
    <input type="password" id="wachtwoordInput" placeholder="Wachtwoord">
    <button onclick="checkWachtwoord()">Inloggen</button>
    <p id="foutmelding">‚ùå Onjuist wachtwoord, probeer opnieuw.</p>
  </div>

  <!-- Formulier kaart -->
  <div class="card hidden" id="formulierCard">
    <div class="logo">
      <img src="Logo%20akkerlinge%20basis.png" alt="Akkerlinge logo">
    </div>
    <h1>Betaalvoorkeur contributie + BBQ formulier</h1>

    <form id="betalingForm" action="https://formspree.io/f/xanpevey" method="POST">
      <h3>Contributie</h3>
      <label>
        Contributie leden vanaf 16 jaar (‚Ç¨25):
        <input type="number" id="contributieVolw" name="contributie_volwassenen" min="0" value="0">
      </label>

      <h3>BBQ</h3>
      <label>
        BBQ Volwassenen (‚Ç¨25):
        <input type="number" id="bbqVolw" name="bbq_volwassenen" min="0" value="0">
      </label>
      <label>
        BBQ Kinderen t/m 16 jaar (‚Ç¨12,50):
        <input type="number" id="bbqKind" name="bbq_kinderen" min="0" value="0">
      </label>

      <label>
        Voor wie (namen):
        <input type="text" name="voor_wie" required>
      </label>

      <label>
        Betaalwijze:
        <select name="betaalwijze">
          <option value="Tikkie">Tikkie</option>
          <option value="Contant">Contant</option>
        </select>
      </label>

      <input type="hidden" id="totaalbedrag" name="totaalbedrag">
      <input type="hidden" id="samenvatting" name="samenvatting">

      <div class="totaal" id="totaalDisplay">Totaal: ‚Ç¨0,00</div>

      <button type="submit">Versturen</button>
    </form>

    <div id="bedanktMelding" class="bedankt hidden">
    Bedankt voor het doorgeven van je betalingsvoorkeur!  
    We hebben je gegevens ontvangen.  

    üëâ Bij gekozen optie <b>Tikkie</b> ontvang je binnenkort een tikkie van Bennie.  
    üëâ Bij gekozen optie <b>Contant</b> gelieve het bedrag op de BBQ op vrijdag 3 oktober zo gepast mogelijk te betalen bij Bennie.
    </div>
  </div>

  <script>
    // ==== Wachtwoordcontrole ====
    function checkWachtwoord() {
      const juistWachtwoord = "Akkerlinge2026!"; // jouw wachtwoord
      const input = document.getElementById("wachtwoordInput").value.trim();
      if (input === juistWachtwoord) {
        document.getElementById("loginCard").classList.add("hidden");
        document.getElementById("formulierCard").classList.remove("hidden");
      } else {
        document.getElementById("foutmelding").style.display = "block";
      }
    }

    // ==== Formulier berekening ====
    const prijzen = { volwassene: 25, kind: 12.5 };
    const contributieVolw = document.getElementById("contributieVolw");
    const bbqVolw = document.getElementById("bbqVolw");
    const bbqKind = document.getElementById("bbqKind");
    const totaalDisplay = document.getElementById("totaalDisplay");
    const totaalInput = document.getElementById("totaalbedrag");
    const samenvattingInput = document.getElementById("samenvatting");
    const form = document.getElementById("betalingForm");
    const bedanktMelding = document.getElementById("bedanktMelding");

    function updateTotaal() {
      const cv = parseInt(contributieVolw.value) || 0;
      const bv = parseInt(bbqVolw.value) || 0;
      const bk = parseInt(bbqKind.value) || 0;
      const totaal = cv*prijzen.volwassene + bv*prijzen.volwassene + bk*prijzen.kind;
      totaalDisplay.textContent = `Totaal: ‚Ç¨${totaal.toFixed(2)}`;
      totaalInput.value = `‚Ç¨${totaal.toFixed(2)}`;
      let onderdelen = [];
      if (cv>0) onderdelen.push(`${cv} volwassene(n) contributie`);
      if (bv>0) onderdelen.push(`${bv} volwassene(n) BBQ`);
      if (bk>0) onderdelen.push(`${bk} kind(eren) BBQ`);
      samenvattingInput.value = onderdelen.length>0 ? onderdelen.join(" + ")+` = ‚Ç¨${totaal.toFixed(2)}` : "Geen keuze";
    }
    [contributieVolw, bbqVolw, bbqKind].forEach(el => el.addEventListener("input", updateTotaal));
    updateTotaal();

    // ==== Confetti ====
    const confettiCanvas = document.getElementById("confetti-canvas");
    const ctx = confettiCanvas.getContext("2d");
    let confettiPieces = [];

    function resizeCanvas() {
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function randomConfettiPiece() {
      const colors = ["#1e6b34", "#006b6b", "#ffcc00", "#ff0066", "#00ccff"];
      return {
        x: Math.random()*confettiCanvas.width,
        y: Math.random()*-20,
        w: 8,
        h: 14,
        color: colors[Math.floor(Math.random()*colors.length)],
        speed: 2+Math.random()*3,
        rotation: Math.random()*360,
        rotationSpeed: Math.random()*10-5
      };
    }

    function drawConfetti() {
      ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
      confettiPieces.forEach((p,i) => {
        p.y += p.speed;
        p.rotation += p.rotationSpeed;
        if (p.y > confettiCanvas.height) confettiPieces[i] = randomConfettiPiece();
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rotation * Math.PI/180);
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);
        ctx.restore();
      });
      if (confettiPieces.length>0) requestAnimationFrame(drawConfetti);
    }

    function startConfetti() {
      confettiPieces = Array.from({length:300}, randomConfettiPiece);
      drawConfetti();
      setTimeout(()=> confettiPieces=[], 22000);
    }

    // ==== Form versturen ====
    form.addEventListener("submit", function(e) {
      e.preventDefault();
      const data = new FormData(form);
      fetch(form.action, {
        method: form.method,
        body: data,
        headers: { 'Accept': 'application/json' }
      }).then(response => {
        if (response.ok) {
          form.classList.add("hidden");
          bedanktMelding.classList.remove("hidden");
          startConfetti();
          setTimeout(() => { window.location.href = window.location.href; }, 23000);
        } else {
          alert("Er is iets misgegaan, probeer het opnieuw.");
        }
      }).catch(() => alert("Netwerkfout, probeer het opnieuw."));
    });
  </script>
</body>
</html>

